"use strict";!function(a,t){function i(){a(".loading").show()}function e(){a(".loading").hide()}function n(n){var s=a("#productList-container"),d=20;if(s.data("loading")!==!0){if(s.data("loading",!0),1===n)var l=s.data("pagenum");else var l=0;if(l!==-1){var u=++l,p=a(".search-item.active").data("categoryid");i();var m;m=""!=c?"/products?extra_kv=sea:"+c:""!=r?"/products?extra_kv=sea:"+r:"/products",a.ajax({url:m,data:{pagenum:u,pagesize:d,cid:p}}).done(function(i){if(i.success)if(null===i.data||""===i.data||0===i.data.list.length)s.data("pagenum",-1);else{o(i.data,n),s.data("pagenum",u),a.ajax({url:i.data.impr}),a("img.img-lazy").lazyload({threshold:200,container:a("#productList-container"),effect:"fadeIn"});new t(".swiper-container",{pagination:".swiper-pagination",paginationClickable:!0,paginationType:"bullets",lazyLoading:!0,lazyLoadingInPrevNext:!0,onSlideChangeStart:function(t){a(t.bullets).css("opacity","0.6"),setTimeout(function(){a(t.bullets).css("opacity","0")},2e3)}});a("[data-clk]").unbind("click"),a("[data-clk]").bind("click",function(){var t=a(this);a("#productClick-name").val(t.data("title")),a("#productClick-spu").val(t.data("spu")),a("#productClick-price").val(t.data("price")),void 0!==t.data("link")&&(a.ajax({url:t.data("clk"),type:"GET"}),setTimeout(function(){window.location.href=t.data("link")},100))})}}).always(function(){e(),s.data("loading",!1)})}}}function o(t,i){var e=template("tpl-product",t),n=a.parseHTML(e);1===i?a("#productList-container").find(".row").append(n):2===i&&(a(".productList").each(function(){a(this).html("")}),a("#productList-container").find(".row").html(n))}function s(){var t=window.pageYOffset,i=a(document).height()-a(window).height();t!==i&&i<=300+t&&n(1)}var c="",d=0;a("#header").headroom({tolerance:.5,offset:44,classes:{top:"animated",notTop:"animated",bottom:"animated",notBottom:"animated",initial:"animated",pinned:"slideInDown",unpinned:"slideOutUp"}}),a("#tabIndex-container").headroom({tolerance:.5,offset:44,classes:{top:"animated",notTop:"animated",bottom:"animated",notBottom:"animated",initial:"animated",pinned:"tabIndexDown",unpinned:"tabIndexUp"}}),a("#nav-categoryTit").on("click",function(){var t=a(".search-container");return t.toggleClass("active"),a(this).toggleClass("active"),t.hasClass("active")?(t.slideDown("fast"),a("#productList-container").addClass("dark-mask"),a(".nav-category .titDiv").addClass("border-b")):(t.slideUp("fast"),a("#productList-container").removeClass("dark-mask"),a(".nav-category .titDiv").removeClass("border-b")),!1}),a(".search-item").on("click",function(){a(".search-item").removeClass("active"),a(this).addClass("active"),a(".search-container").toggleClass("active"),a("#nav-categoryTit").toggleClass("active"),a(".search-container").slideUp("fast"),a("#productList-container").removeClass("dark-mask"),a(".nav-category .titDiv").removeClass("border-b"),d=a(this).data("categoryid"),a("#productList-container").data("pagenum",0),a("#productList-container").data("loading",!1),a("#nav-categoryTit").html(a(this).data("categoryname")),n(2)});var r;!function(){r=location.hash.substring(1);var t=!1,i="",e=0;a.each(a("[data-search]"),function(n,o){if(a(this).data("search")===parseInt(r))return t=!0,i=a(this).data("searchtext"),e=n+1,!1}),t||(r=""),""!=r?(a("#productList-container").data("pagenum",0),a("#productList-container").data("loading",!1),a("#sortBy option:eq("+e+")").attr("selected","selected"),a(".lowTo-info").html(i),a(".lowTo").removeClass("disabled"),n(2)):n(1)}(),a(".btn-sortBy").on("change",function(){var t=a(".btn-sortBy option:selected");"reset"==t.data("searchtext")?(c="",a(".lowTo-info").html(c),a(".lowTo").addClass("disabled")):(c=t.data("search"),a(".lowTo-info").html(t.data("searchtext")),a(".lowTo").removeClass("disabled")),a("#productList-container").data("pagenum",0),a("#productList-container").data("loading",!1),n(2)}),a(".btn-sortBy").on("click",function(){}),a(document).ready(function(){a(window).scroll(function(){a("img.img-lazy").each(function(){var t=a(this).attr("src"),i=a(this).attr("data-original");t===i&&a(this).removeClass("img-lazy")}),s()})}),a("#productList-container").on("click",".btn-wish",function(t){var i=a(t.target),e=a(t.target).data("spu");void 0!=e?(i.hasClass("active")?i.removeClass("active"):i.addClass("active"),a.ajax({url:"/updateWish",type:"post",data:{spu:e}})):(e=i.data("actionspu"),a.ajax({url:"/notesaction",type:"get",data:{action:"wish",spu:e}}).done(function(a){window.location.href="/login"}))})}(jQuery,Swiper);