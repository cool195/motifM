"use strict";!function(a,t){function n(){a(".loading").show()}function e(){a(".loading").hide()}function i(t){var i=a("#productList-container"),c=20;if(i.data("loading")!==!0){if(i.data("loading",!0),1===t)var r=i.data("pagenum");else var r=0;if(r!==-1){var l=++r,u=a(".search-item.active").data("categoryid");n();var p;""!=d?(console.log("SearchType==="+d),p="/products?extra_kv=sea:"+d):p="/products",a.ajax({url:p,data:{pagenum:l,pagesize:c,cid:u}}).done(function(n){n.success&&(null===n.data||""===n.data||0===n.data.list.length?i.data("pagenum",-1):(console.log(s),console.log(p),o(n.data,t),i.data("pagenum",l),a.ajax({url:n.data.impr}),a("img.img-lazy").lazyload({threshold:200,container:a("#productList-container"),effect:"fadeIn"}),a("[data-clk]").unbind("click"),a("[data-clk]").bind("click",function(){var t=a(this);a("#productClick-name").val(t.data("title")),a("#productClick-spu").val(t.data("spu")),a("#productClick-price").val(t.data("price")),void 0!==t.data("link")&&(a.ajax({url:t.data("clk"),type:"GET"}),setTimeout(function(){window.location.href=t.data("link")},100))})))}).always(function(){e(),i.data("loading",!1)})}}}function o(t,n){var e=template("tpl-product",t),i=a.parseHTML(e);1===n?a("#productList-container").find(".row").append(i):2===n&&(a(".productList").each(function(){a(this).html("")}),a("#productList-container").find(".row").html(i))}function c(){var t=window.pageYOffset,n=a(document).height()-a(window).height();t!==n&&n<=300+t&&i(1)}var d="",s=0;a("#header").headroom({tolerance:.5,offset:44,classes:{top:"animated",notTop:"animated",bottom:"animated",notBottom:"animated",initial:"animated",pinned:"slideInDown",unpinned:"slideOutUp"}}),a("#tabIndex-container").headroom({tolerance:.5,offset:44,classes:{top:"animated",notTop:"animated",bottom:"animated",notBottom:"animated",initial:"animated",pinned:"tabIndexDown",unpinned:"tabIndexUp"}}),a("#nav-categoryTit").on("click",function(){var t=a(".search-container");return t.toggleClass("active"),a(this).toggleClass("active"),t.hasClass("active")?(t.slideDown("fast"),a("#productList-container").addClass("dark-mask"),a(".nav-category .titDiv").addClass("border-b")):(t.slideUp("fast"),a("#productList-container").removeClass("dark-mask"),a(".nav-category .titDiv").removeClass("border-b")),!1}),a(".search-item").on("click",function(){a(".search-item").removeClass("active"),a(this).addClass("active"),a(".search-container").toggleClass("active"),a("#nav-categoryTit").toggleClass("active"),a(".search-container").slideUp("fast"),a("#productList-container").removeClass("dark-mask"),a(".nav-category .titDiv").removeClass("border-b"),s=a(this).data("categoryid"),a("#productList-container").data("pagenum",0),a("#productList-container").data("loading",!1),a("#nav-categoryTit").html(a(this).data("categoryname")),i(2)}),function(){i(1)}(),a(".btn-sortBy").on("change",function(){var t=a(".btn-sortBy option:selected");"reset"==t.data("searchtext")?(d="",a(".lowTo-info").html(d),a(".lowTo").addClass("disabled")):(console.log(a(this).val()),d=t.data("search"),a(".lowTo-info").html(t.data("searchtext")),a(".lowTo").removeClass("disabled")),a("#productList-container").data("pagenum",0),a("#productList-container").data("loading",!1),i(2)}),a(".btn-sortBy").on("click",function(){}),a(document).ready(function(){a(window).scroll(function(){a("img.img-lazy").each(function(){var t=a(this).attr("src"),n=a(this).attr("data-original");t===n&&a(this).removeClass("img-lazy")}),c()})}),a("#productList-container").on("click",".btn-wish",function(t){var n=a(t.target),e=a(t.target).data("spu");void 0!=e?(n.hasClass("active")?n.removeClass("active"):n.addClass("active"),a.ajax({url:"/updateWish",type:"post",data:{spu:e}})):(e=n.data("actionspu"),a.ajax({url:"/notesaction",type:"get",data:{action:"wish",spu:e}}).done(function(a){window.location.href="/login"}))})}(jQuery,Swiper);