"use strict";!function(a){function i(){a(".wishloading").show()}function n(){a(".wishloading").hide()}function t(){a(".loading").toggleClass("loading-hidden"),setTimeout(function(){a(".loading").toggleClass("loading-open")},25)}function o(){a(".loading").addClass("loading-close"),setTimeout(function(){a(".loading").toggleClass("loading-hidden loading-open").removeClass("loading-close")},500)}function s(){var t=a("#wishContainer"),o=t.data("wishpagenum");if(o!==-1&&t.data("loading")!==!0){t.data("loading",!0);var s=++o;i(),a.ajax({url:"/wish",data:{num:s,size:10,ajax:1}}).done(function(i){null===i.data||""===i.data?t.data("wishpagenum",-1):null===i.data.list||""===i.data.list||void 0===i.data.list||0===i.data.list.length?(t.data("wishpagenum",-1),u||(a("#emptyWishlist").removeClass("hidden-xs-up"),u=!0)):(u||(a("#emptyWishlist").addClass("hidden-xs-up"),u=!0),e("tpl-wishlist",i.data),t.data("wishpagenum",o),a("img.img-lazy").lazyload({threshold:200,effect:"fadeIn"}))}).always(function(){t.data("loading",!1),n()})}}function e(i,n){var t=template(i,n),o=a.parseHTML(t);a("#wishContainer").append(o)}function l(){var i=window.pageYOffset,n=a(document).height()-a(window).height();i!==n&n<=300+i&&s()}var d={closeOnOutsideClick:!1,closeOnCancel:!1,hashTracking:!1},c=a('[data-remodal-id="modal"]').remodal(d);a("#wishContainer").on("click",".delwish",function(i){a("#wishDialog").data("spu",a(i.target).data("spu")),c.open()}),a('[data-remodal-action="confirm"]').on("click",function(){var i=a("#wishDialog").data("spu");t(),a.ajax({url:"/updateWish",type:"post",data:{spu:i}}).done(function(n){n.success&&a('[data-wishspu="'+i+'"]').remove()}).always(function(){a(".wishlist-item").length<=0&&u&&(a("#emptyWishlist").removeClass("hidden-xs-up"),u=!0),o()})}),a('[data-remodal-action="cancel"]').on("click",function(){a("#wishDialog").data("spu",""),c.close()}),a(function(){a("img.img-lazy").lazyload({threshold:200,effect:"fadeIn"})});var u=!1;a(document).ready(function(){s(),a(window).scroll(function(){a("img.img-lazy").each(function(){var i=a(this).attr("src"),n=a(this).attr("data-original");i===n&&a(this).removeClass("img-lazy")}),l()})})}(jQuery);