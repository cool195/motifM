"use strict";!function(a){function t(){a(".loading").toggleClass("loading-hidden"),setTimeout(function(){a(".loading").toggleClass("loading-open")},25)}function o(){a(".loading").addClass("loading-close"),setTimeout(function(){a(".loading").toggleClass("loading-hidden loading-open").removeClass("loading-close")},500)}function n(){onRemoveFromCart();var n=a("#cartDialog").data("sku"),i=a("#cartDialog").data("action");void 0!==n&&void 0!==i&&""!==n&&""!==i&&null!==n&&null!==i&&(t(),a.ajax({url:"/cart/operate",type:"POST",data:{cmd:i,sku:n}}).done(function(a){a.success&&location.reload()}).fail(function(){console.log("error")}).always(function(){o(),console.log("complete")}))}function i(n,i){return void 0===i||void 0===n||""===i||""===n||null===i||null===n?void console.log("sku||action 为空"):(t(),void a.ajax({url:"/cart/operate",type:"POST",data:{cmd:n,sku:i}}).done(function(a){a.success&&location.reload()}).fail(function(){console.log("error")}).always(function(){o()}))}function e(n,i,e){t(),a.ajax({url:"/cart/alterQtty",type:"POST",data:{sku:n,qtty:i}}).done(function(a){a.success&&(location.reload(),e.siblings("[data-count]").html(i))}).fail(function(){console.log("error")}).always(function(){o()})}function l(){var t=a("#userEmail").val(),o=o||[];o.push(["identify",{$email:t}]),trackProceedToCheckout()}a("img.img-lazy").lazyload({threshold:200,effect:"fadeIn"}),a(".item-count").on("click","[data-item]",function(t){var o;if(o="I"===a(t.target)[0].tagName?a(t.target).parents(".btn-cartCount"):a(t.target),!o.hasClass("disabled")){var n=parseInt(o.siblings("[data-count]").html()),i=a(t.target).parents(".item-count").data("sku"),l=n;"add"===o.data("item")?l++:l--,e(i,l,o)}}),a('[data-remodal-target="modal"]').click(function(t){a("#cartDialog").data("sku",a(t.target).data("sku")),a("#cartDialog").data("action",a(t.target).data("action")),a("#removeFromCart-name").val(a(this).data("title")),a("#removeFromCart-spu").val(a(this).data("spu")),a("#removeFromCart-price").val(a(this).data("price")),a("#removeFromCart-quantity").val(a(this).data("qtty"))}),a("#cartDialog").remodal({closeOnOutsideClick:!1,hashTracking:!1}),a("#cartDialog").on("closed",function(){a(this).removeData("sku").removeData("action")}),a("#cartDialog").on("confirmation",function(){n()}),a("[data-product-move]").on("click",function(){var t=a(this).data("product-move"),o=a(this).data("sku");i(t,o)}),a("[data-item-qty]").on("click",function(t){var o;if(o="I"===a(t.target)[0].tagName?a(t.target).parents(".btn-cartCount"):a(t.target),!o.hasClass("disabled")){var n=o.parents(".btn-group").data("sku"),i=o.siblings("[data-item-num]").data("item-num");"add"===o.data("item-qty")?i++:i--,e(n,i)}}),a(".cartKlaviyo").on("click",function(){l()})}(jQuery);